/*-------------------------------------------------------------------*
 *                                                                   *
 *                       Bihl+Wiedemann GmbH                         *
 *                                                                   *
 *                                                                   *
 *       project: C-control program                                  *
 *   Sample name: EDM Tester                                        *
 *        author: Dony Meitia                                    *
 *          date: 2010-08-04                                         *
 *                                                                   *
 *      RCS info:                                                    *
 *         $Date: 2009/10/21 12:37:52 $
 *     $Revision: 1.1.2.1.2.2 $
 */
/*! \file
 *	\brief	
 *
 */
/*                                                                   *
 *-------------------------------------------------------------------*/

/*-------------------------------------------------------------------*
 *  include files                                                    *
 *-------------------------------------------------------------------*/
//#include "string.h"
#include "control.h"

/*-------------------------------------------------------------------*
 *  local definitions                                                *
 *-------------------------------------------------------------------*/

/*-------------------------------------------------------------------*
 *  public data                                                      *
 *-------------------------------------------------------------------*/

volatile ccontrol_func_t cctrl_func __attribute__ ((__section__ (".funcarea")));

/*-------------------------------------------------------------------*
 *  private data                                                     *
 *-------------------------------------------------------------------*/
volatile unsigned int system_ticks;
volatile unsigned int 		state;
volatile unsigned int 		state1;
volatile unsigned int 		state2;
volatile unsigned int 		state3;
volatile unsigned int 		state4;
int bp_stop;
/*-------------------------------------------------------------------*
 *  private functions                                                *
 *-------------------------------------------------------------------*/

/*-------------------------------------------------------------------*
 *  public functions                                                 *
 *-------------------------------------------------------------------*/

static void timer_function ( void )
{
	/* timer interrupt every 10 ms */
	
	system_ticks++;
}

void test (void)
{
	state++;
}
		  
int main()
{
	//to initialize the GDB and the breakpoints
	cctrl_func.CCtrlBreakpoint();


	unsigned int timer_1;
	unsigned char flags;

	AASiProcessData 	odi;
	AASiProcessData 	idi;
	AASiEcFlags     	ecflags;


    /* init timer function with 10 ms ticks */
    cctrl_func.CCtrlInitTimer(10, timer_function);

	timer_1 = system_ticks;
	state = 1;	

	cctrl_func.CCtrlDelay(2000);
	




	for(;;)
    {
	
	 	//cctrl_func.CCtrlTriggerWdg();
		 if (bp_stop != 5) 
		 {
			 state++;
		 }

		 state1++;
		 state2++;
		 state3++;
		 state4++;

		 test();


		// read flags to check if we should stop control
		cctrl_func.CCtrlReadFlags( &flags );

		state4++;

		if ( !( flags & CCTRL_FLAG_RUN ) )
		{
			return 1;
		}

	} // for (;;)  

	return 0;
}

/*-------------------------------------------------------------------*
 *  eof                                                              *
 *-------------------------------------------------------------------*/

